(window.webpackJsonp=window.webpackJsonp||[]).push([[109],{535:function(a,s,t){"use strict";t.r(s);var n=t(0),e=Object(n.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h2",{attrs:{id:"一、为什么要实现配置管理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一、为什么要实现配置管理"}},[a._v("#")]),a._v(" 一、为什么要实现配置管理")]),a._v(" "),s("ul",[s("li",[a._v("不同环境，不同配置")]),a._v(" "),s("li",[a._v("配置属性动态刷新")])]),a._v(" "),s("h2",{attrs:{id:"二、使用nacos管理配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#二、使用nacos管理配置"}},[a._v("#")]),a._v(" 二、使用Nacos管理配置")]),a._v(" "),s("h3",{attrs:{id:"_2-1-导入依赖"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-导入依赖"}},[a._v("#")]),a._v(" 2.1 导入依赖")]),a._v(" "),s("div",{staticClass:"language-xml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[a._v("       "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n            "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("org.springframework.cloud"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n            "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("spring-cloud-alibaba-nacos-config"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br")])]),s("h3",{attrs:{id:"_2-2-编写配置-bootstrap-yml"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-编写配置-bootstrap-yml"}},[a._v("#")]),a._v(" 2.2 编写配置 bootstrap.yml")]),a._v(" "),s("div",{staticClass:"language-yml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-yml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("spring")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("cloud")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("nacos")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("config")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("server-addr")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" 127.0.0.1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("8848")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("file-extension")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" yaml\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("application")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" content"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("center\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("profiles")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("active")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" dev\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br")])]),s("h3",{attrs:{id:"_2-3-登录nacos后台-添加配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-登录nacos后台-添加配置"}},[a._v("#")]),a._v(" 2.3 登录Nacos后台，添加配置")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://image.xuguoliang.top/2022/03/08/image-20220308013235795_jJg7tN.png",alt:"image-20220308013235795"}})]),a._v(" "),s("blockquote",[s("p",[a._v("Group ID:（spring.application.name)+(spring.profiiles.active)+(.)+(spring.cloud.nacos.config.file-extension)")])]),a._v(" "),s("h3",{attrs:{id:"_2-4-配置动态刷新"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-配置动态刷新"}},[a._v("#")]),a._v(" 2.4 配置动态刷新")]),a._v(" "),s("p",[a._v("配置的动态刷新，仅需要使用"),s("code",[a._v("@RefreshScope")]),a._v("注解即可。")]),a._v(" "),s("h3",{attrs:{id:"_2-5-同一个应用在不同环境下的配置共享"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-5-同一个应用在不同环境下的配置共享"}},[a._v("#")]),a._v(" 2.5 同一个应用在不同环境下的配置共享")]),a._v(" "),s("p",[s("code",[a._v("2022-03-08 01:33:12.022 INFO 33489 --- [ main] b.c.PropertySourceBootstrapConfiguration : Located property source: CompositePropertySource {name='NACOS', propertySources=[NacosPropertySource {name='content-center-dev.yaml'}, NacosPropertySource {name='content-center.yaml'}]}")])]),a._v(" "),s("p",[a._v("创建一个 "),s("code",[a._v("content-center.yaml")])]),a._v(" "),s("h3",{attrs:{id:"_2-6-引导上下文"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-6-引导上下文"}},[a._v("#")]),a._v(" 2.6 引导上下文")]),a._v(" "),s("p",[s("strong",[a._v("bootstrap.yml")]),a._v(" 就是引导上下文的配置文件。对于应用，就是来连接Nacos以读取Nacos中的配置。")]),a._v(" "),s("p",[a._v("远程配置(Nacos) & 本地配置优先级")]),a._v(" "),s("p",[a._v("默认情况下,远程配置优先级较高哦")]),a._v(" "),s("p",[a._v("如下的配置文件必须放在远程配置中才生效")]),a._v(" "),s("div",{staticClass:"language-yml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-yml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("spring")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("cloud")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("nacos")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("config")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 是否允许本地覆盖远程配置")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("allow-override")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token boolean important"}},[a._v("true")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 是否一切以本地配置为准，默认false")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("override-none")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token boolean important"}},[a._v("false")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 系统环境变量或系统属性才能覆盖远程文件的配置")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 本地配置文件中配置优先级低于远程配置，默认 true")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("override-system-properties")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token boolean important"}},[a._v("true")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br")])]),s("h2",{attrs:{id:"三、-nacos数据持久化"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#三、-nacos数据持久化"}},[a._v("#")]),a._v(" 三、 Nacos数据持久化")]),a._v(" "),s("h3",{attrs:{id:"_3-1-作为服务发现组件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-作为服务发现组件"}},[a._v("#")]),a._v(" 3.1 作为服务发现组件")]),a._v(" "),s("p",[a._v("其数据都是存在本地路径:")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("~/nacos/naming/public\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h3",{attrs:{id:"_3-2-作为配置服务器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-作为配置服务器"}},[a._v("#")]),a._v(" 3.2 作为配置服务器")]),a._v(" "),s("p",[a._v("数据分成两部分")]),a._v(" "),s("ul",[s("li",[a._v("Nacos web ui中配置的配置数据")])]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$NACOS_HOME")]),a._v("/data/derby-data\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("ul",[s("li",[a._v("配置属性快照")])]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("~/nacos/config\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h2",{attrs:{id:"四、搭建生产可用的nacos集群"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#四、搭建生产可用的nacos集群"}},[a._v("#")]),a._v(" 四、搭建生产可用的Nacos集群")]),a._v(" "),s("p",[s("a",{attrs:{href:"https://www.imooc.com/article/288153",target:"_blank",rel:"noopener noreferrer"}},[a._v("参考手记"),s("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=e.exports}}]);